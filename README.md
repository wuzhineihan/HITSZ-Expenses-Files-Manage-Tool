# 社团报销文件夹自动化管理系统# 社团报销文件夹自动化管理系统# 社团报销文件夹自动化管理系统# 社团报销文件夹自动化管理系统# 社团报销文件夹自动化管理系统



[![Python](https://img.shields.io/badge/Python-3.7+-blue.svg)](https://www.python.org/)

[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)

[![Python](https://img.shields.io/badge/Python-3.7+-blue.svg)](https://www.python.org/)

一个智能的报销文件夹管理系统,自动创建文件夹、追踪文件、管理报销流程。支持自动监控、**智能分类**、**行号排序**、智能重命名、文件数量检测等功能。

[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)

## 📋 目录

[![Python](https://img.shields.io/badge/Python-3.7+-blue.svg)](https://www.python.org/)

- [核心功能](#核心功能)

- [快速开始](#快速开始)一个智能的报销文件夹管理系统,自动创建文件夹、追踪文件、管理报销流程。支持自动监控、**智能分类**、**行号排序**、智能重命名、文件数量检测等功能。

- [使用方法](#使用方法)

- [智能等待功能](#智能等待功能)[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)

- [主要操作](#主要操作)

- [文件说明](#文件说明)## 📋 目录

- [使用场景示例](#使用场景示例)

- [常见问题](#常见问题)[![Python](https://img.shields.io/badge/Python-3.7+-blue.svg)](https://www.python.org/)[![Python](https://img.shields.io/badge/Python-3.7+-blue.svg)](https://www.python.org/)

- [注意事项](#注意事项)

- [核心功能](#核心功能)

---

- [快速开始](#快速开始)一个智能的报销文件夹管理系统,自动创建文件夹、追踪文件、管理报销流程。支持自动监控、**智能分类**、智能重命名、文件数量检测等功能。

## 核心功能

- [使用方法](#使用方法)

### 1. 📁 自动创建文件夹 + 智能分类 + 行号排序 ⭐NEW

- [智能等待功能](#智能等待功能)[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)

根据"材料准备"状态自动分类存放文件夹,并添加Excel行号前缀:

- [主要操作](#主要操作)

- **✅已完成/** - 材料准备为 `yes` 的文件夹

  - 例如: `✅已完成/张大佑/3.社团招新传单/`- [文件说明](#文件说明)## 📋 目录

  

- **📋待处理/** - 材料准备不为 `yes` 的文件夹  - [使用场景示例](#使用场景示例)

  - 例如: `📋待处理/张大佑/2.打印证书/`

- [常见问题](#常见问题)

**行号前缀**: 文件夹名称自动添加Excel行号(如 `3.社团招新传单`),在文件管理器中按名称排序时与Excel顺序完全一致!

- [注意事项](#注意事项)

**优势**: 

- ✅ 快速找到还没处理完的文件夹- [核心功能](#核心功能)

- ✅ 文件夹顺序与Excel完全对应

- ✅ 一眼看出这是第几条记录---

- ✅ 提高工作效率!

- [快速开始](#快速开始)一个智能的报销文件夹管理系统,自动创建文件夹、追踪文件、管理报销流程。支持自动监控、智能重命名、文件数量检测等功能。一个智能的报销文件夹管理系统,自动创建文件夹、追踪文件、管理报销流程。

### 2. 🔄 智能重命名 + 自动迁移

## 核心功能

- 修改Excel中的内容,文件夹自动重命名

- **修改状态时自动迁移**: 当"材料准备"状态改变时,文件夹自动移动- [使用方法](#使用方法)

  - `yes` → 移动到 `✅已完成/`

  - `no/check` → 移动到 `📋待处理/`### 1. 📁 自动创建文件夹 + 智能分类 + 行号排序 ⭐NEW

- **行号自动更新**: 当Excel行顺序改变时,文件夹名称中的行号自动更新

- 保留文件夹中的所有文件- [智能等待功能](#智能等待功能)

- 不会创建重复文件夹

根据"材料准备"状态自动分类存放文件夹,并添加Excel行号前缀:

### 3. 📊 文件数量检测 + 自动统计

- [主要操作](#主要操作)

自动检测每个文件夹中的文件数量:

- **✅已完成/** - 材料准备为 `yes` 的文件夹

- **自动更新"文件数量"列** - 实时显示具体有多少个文件

- **自动更新"材料准备"状态**:  - 例如: `✅已完成/张大佑/3.社团招新传单/`- [文件说明](#文件说明)## 📋 目录## 📋 目录

  - 文件数 < 3 → `no` (材料不足)

  - 文件数 ≥ 3 且状态不是`yes` → `check` (需要审核)  

  - 文件数 ≥ 3 且状态是`yes` → 保持`yes`

- **📋待处理/** - 材料准备不为 `yes` 的文件夹  - [使用场景示例](#使用场景示例)

### 4. 🔍 唯一ID追踪系统

  - 例如: `📋待处理/张大佑/2.打印证书/`

- 为每一行数据生成唯一ID

- 支持新增、修改、删除行- [常见问题](#常见问题)

- 智能匹配现有记录

- 即使调整行顺序也能正确追踪**行号前缀**: 文件夹名称自动添加Excel行号(如 `3.社团招新传单`),在文件管理器中按名称排序时与Excel顺序完全一致!



### 5. 🗑️ 智能删除- [注意事项](#注意事项)



- 删除Excel行后,空文件夹自动删除**优势**: 

- 有文件的文件夹自动保留(防止误删)

- 空的付款人文件夹也会被清理- ✅ 快速找到还没处理完的文件夹- [核心功能](#核心功能)- [核心功能](#核心功能)

- 自动清理未追踪的嵌套文件夹

- ✅ 文件夹顺序与Excel完全对应

### 6. 👁️ 自动监控 (推荐)

- ✅ 一眼看出这是第几条记录---

- 实时监控Excel文件变化

- 保存后自动执行脚本- ✅ 提高工作效率!

- 智能等待Excel关闭后再执行

- [快速开始](#快速开始)- [快速开始](#快速开始)

---

### 2. 🔄 智能重命名 + 自动迁移

## 快速开始

## 核心功能

### 安装依赖

- 修改Excel中的内容,文件夹自动重命名

```bash

pip install pandas openpyxl watchdog- **修改状态时自动迁移**: 当"材料准备"状态改变时,文件夹自动移动- [使用方法](#使用方法)- [使用方法](#使用方法)

```

  - `yes` → 移动到 `✅已完成/`

### 第一次使用

  - `no/check` → 移动到 `📋待处理/`### 1. 📁 自动创建文件夹 + 智能分类 ⭐NEW

1. 将 `社团报销.xlsx` 放在工作目录

2. 双击运行 `启动自动监控.bat` (推荐) 或 `运行一次.bat`- **行号自动更新**: 当Excel行顺序改变时,文件夹名称中的行号自动更新

3. 系统会自动:

   - 创建 `✅已完成/` 和 `📋待处理/` 文件夹- 保留文件夹中的所有文件- [智能等待功能](#智能等待功能)- [自动监控功能](#自动监控功能)

   - 根据状态分类存放所有文件夹

   - 为文件夹名称添加行号前缀- 不会创建重复文件夹

   - 添加"唯一ID"和"文件数量"列到Excel

   - 生成元数据文件根据"材料准备"状态自动分类存放文件夹:

   - 检测文件数量并更新状态

### 3. 📊 文件数量检测 + 自动统计

---

- [主要操作](#主要操作)- [智能等待功能](#智能等待功能)

## 使用方法

自动检测每个文件夹中的文件数量:

### 方式一:自动监控(推荐) 🎯

- **✅已完成/** - 材料准备为 `yes` 的文件夹

**适合频繁修改Excel时使用**

- **自动更新"文件数量"列** - 实时显示具体有多少个文件

#### 启动方法

- **自动更新"材料准备"状态**:  - 例如: `✅已完成/张大佑/社团招新传单/`- [文件说明](#文件说明)- [文件说明](#文件说明)

**选项1: 双击启动** (最简单)

```  - 文件数 < 3 → `no` (材料不足)

双击 → 启动自动监控.bat

```  - 文件数 ≥ 3 且状态不是`yes` → `check` (需要审核)  



**选项2: 命令行启动**  - 文件数 ≥ 3 且状态是`yes` → 保持`yes`

```bash

python auto_watch.py- **📋待处理/** - 材料准备不为 `yes` 的文件夹  - [使用场景示例](#使用场景示例)- [常见问题](#常见问题)

```

### 4. 🔍 唯一ID追踪系统

#### 工作流程

  - 例如: `📋待处理/张大佑/打印证书/`

```

1. 启动监控(保持窗口打开)- 为每一行数据生成唯一ID

   ↓

2. 打开Excel,编辑数据- 支持新增、修改、删除行- [常见问题](#常见问题)- [使用场景示例](#使用场景示例)

   ↓

3. 保存Excel (Ctrl+S)- 智能匹配现有记录

   ↓

4. 继续编辑... (可选)- 即使调整行顺序也能正确追踪**优势**: 快速找到还没处理完的文件夹,提高工作效率!

   ↓

5. 关闭Excel

   ↓

6. 🎯 系统自动执行脚本### 5. 🗑️ 智能删除- [注意事项](#注意事项)- [注意事项](#注意事项)

   ↓

7. 查看监控窗口中的结果

```

- 删除Excel行后,空文件夹自动删除### 2. 🔄 智能重命名 + 自动迁移

#### 停止监控

- 有文件的文件夹自动保留(防止误删)

- 关闭监控窗口

- 或按 `Ctrl+C`- 空的付款人文件夹也会被清理



### 方式二:手动运行



**适合偶尔更新时使用**### 6. 👁️ 自动监控 (推荐)- 修改Excel中的内容,文件夹自动重命名



#### 运行方法



**选项1: 双击运行**- 实时监控Excel文件变化- **修改状态时自动迁移**: 当"材料准备"状态改变时,文件夹自动移动------

```

双击 → 运行一次.bat- 保存后自动执行脚本

```

- 智能等待Excel关闭后再执行  - `yes` → 移动到 `✅已完成/`

**选项2: 命令行**

```bash

python create_folders.py

```---  - `no/check` → 移动到 `📋待处理/`



---



## 智能等待功能## 快速开始- 保留文件夹中的所有文件



### 功能说明



系统会智能检测Excel文件是否被关闭,避免文件被占用导致执行失败。### 安装依赖- 不会创建重复文件夹## 核心功能## 核心功能



### 工作模式



#### 模式A: 保存即关闭 (立即执行)```bash



```pip install pandas openpyxl watchdog

编辑Excel → 保存(Ctrl+S) → 关闭Excel

                              ↓```### 3. 📊 文件数量检测 + 自动统计 ⭐NEW

                         检测到关闭

                              ↓

                         立即执行脚本

                              ↓### 第一次使用

                         完成!

```



⏱️ **执行时机**: 关闭Excel后立即执行1. 将 `社团报销.xlsx` 放在工作目录自动检测每个文件夹中的文件数量:### 1. 📁 自动创建文件夹这是一个智能的报销文件夹管理系统,具有以下功能:



#### 模式B: 保存后继续编辑 (延迟执行)2. 双击运行 `启动自动监控.bat` (推荐) 或 `运行一次.bat`



```3. 系统会自动:

打开Excel

   ↓   - 创建 `✅已完成/` 和 `📋待处理/` 文件夹

修改 → 保存 → 继续修改 → 保存 → 关闭Excel

       ↓               ↓          ↓   - 根据状态分类存放所有文件夹- **自动更新"文件数量"列** - 实时显示具体有多少个文件- 根据Excel中的"付款人"和"开票内容"自动创建文件夹结构

   等待关闭...     等待关闭...  立即执行!

```   - 为文件夹名称添加行号前缀



⏱️ **执行时机**: 最后关闭Excel时才执行   - 添加"唯一ID"和"文件数量"列到Excel- **自动更新"材料准备"状态**:

✅ **优势**: 可以连续编辑,不用每次等待

   - 生成元数据文件

---

   - 检测文件数量并更新状态  - 文件数 < 3 → `no` (材料不足)- 例如: `付款人=张大佑, 开票内容=打印证书` → 创建 `张大佑/打印证书/`### 1. 自动创建文件夹

## 主要操作



### 新增记录

---  - 文件数 ≥ 3 且状态不是`yes` → `check` (需要审核)

1. 在Excel末尾添加新行

2. 填写"付款人"、"开票内容"和"材料准备"

3. **"唯一ID"和"文件数量"列留空**(系统自动生成)

4. 保存Excel(如使用监控)或运行脚本## 使用方法  - 文件数 ≥ 3 且状态是`yes` → 保持`yes`- 根据 Excel 文件中的"付款人"和"开票内容"自动创建对应的文件夹结构

5. 结果:

   - ✅ 自动生成唯一ID

   - ✅ 根据"材料准备"状态创建到对应文件夹

   - ✅ 文件夹名称自动添加Excel行号### 方式一:自动监控(推荐) 🎯

   - ✅ 自动统计文件数量

   - ✅ 保存元数据



### 修改记录**适合频繁修改Excel时使用**### 4. 🔍 唯一ID追踪系统### 2. 🔄 智能重命名- 例如: 付款人=张大佑, 开票内容=打印30天结题证书 → 创建 `张大佑/打印30天结题证书` 文件夹



1. 在Excel中修改"开票内容"、"付款人"或"材料准备"

2. **不要修改"唯一ID"和"文件数量"列!**

3. 保存Excel(如使用监控)或运行脚本#### 启动方法

4. 结果:

   - ✅ 文件夹自动重命名

   - ✅ 状态改变时自动迁移文件夹

   - ✅ 文件夹中的文件完整保留**选项1: 双击启动** (最简单)- 为每一行数据生成唯一ID- 修改Excel中的内容,文件夹自动重命名

   - ✅ 元数据自动更新

```

### 调整行顺序 ⭐NEW

双击 → 启动自动监控.bat- 支持新增、修改、删除行

1. 在Excel中移动某行到其他位置

2. 保存Excel```

3. 结果:

   ```- 智能匹配现有记录- 保留文件夹中的所有文件### 2. 智能元数据管理 ✨ (新功能)

   📦 移动文件夹:

      从: 📋待处理\张大佑\5.打印证书**选项2: 命令行启动**

      到: 📋待处理\张大佑\3.打印证书

   ``````bash

4. 行号自动更新,文件夹顺序与Excel一致!

python auto_watch.py

### 改变状态(触发迁移)

```### 5. 🗑️ 智能删除- 不会创建重复文件夹- 为每一行数据创建唯一的元数据标识

**示例: 将材料从待处理改为已完成**



1. 收集完报销材料后,将"材料准备"改为 `yes`

2. 保存Excel#### 工作流程

3. 结果:

   ```

   📦 移动文件夹:

      从: 📋待处理\张大佑\2.打印证书```- 删除Excel行后,空文件夹自动删除- 元数据存储在 `folder_metadata.json` 文件中

      到: ✅已完成\张大佑\2.打印证书

   ```1. 启动监控(保持窗口打开)

4. 文件夹中的所有文件完整保留!

   ↓- 有文件的文件夹自动保留(防止误删)

### 删除记录

2. 打开Excel,编辑数据

1. 在Excel中删除某一行

2. 保存Excel(如使用监控)或运行脚本   ↓- 空的付款人文件夹也会被清理### 3. 📊 文件数量检测- 记录每一行对应的文件夹路径

3. 结果:

   - ✅ 空文件夹自动删除3. 保存Excel (Ctrl+S)

   - ⚠️ 有文件的文件夹保留并提示

   - ✅ 空的付款人文件夹也被删除   ↓

   - ✅ 元数据标记为已删除

   - ✅ 其他文件夹的行号自动更新4. 继续编辑... (可选)



---   ↓### 6. 👁️ 自动监控 (推荐)自动检测每个文件夹中的文件数量并更新状态:



## 文件说明5. 关闭Excel



### 主要文件   ↓



| 文件名 | 说明 | 是否必需 |6. 🎯 系统自动执行脚本

|--------|------|---------|

| `社团报销.xlsx` | Excel数据源 | ✅ 必需 |   ↓- 实时监控Excel文件变化- 文件数 < 3 → `no` (材料不足)### 3. 自动重命名功能 ✨ (新功能)

| `create_folders.py` | 主程序脚本 | ✅ 必需 |

| `auto_watch.py` | 自动监控脚本 | ⭐ 推荐 |7. 查看监控窗口中的结果

| `启动自动监控.bat` | 一键启动监控 | ⭐ 推荐 |

| `运行一次.bat` | 手动运行一次 | 可选 |```- 保存后自动执行脚本

| `folder_metadata.json` | 元数据(自动生成) | 🚫 勿修改 |



### 文件夹结构 ⭐NEW

#### 停止监控- 智能等待Excel关闭后再执行- 文件数 ≥ 3 且状态不是`yes` → `check` (需要审核)- 当你修改 Excel 中的"开票内容"时,脚本会:

```

社团报销/

├── 社团报销.xlsx           # Excel数据源

├── create_folders.py       # 主程序- 关闭监控窗口

├── auto_watch.py          # 监控脚本

├── 启动自动监控.bat       # 启动文件- 或按 `Ctrl+C`

├── 运行一次.bat           # 手动运行

├── folder_metadata.json   # 元数据---- 文件数 ≥ 3 且状态是`yes` → 保持`yes`  - 自动识别这是同一条记录(通过行索引)

├── README.md             # 本文档

│### 方式二:手动运行

├── ✅已完成/              # 材料准备为'yes'

│   └── 张大佑/

│       ├── 3.社团招新传单/    ← 行号前缀

│       │   ├── 发票.pdf**适合偶尔更新时使用**

│       │   ├── 截图.png

│       │   └── 证明.jpg## 快速开始  - 将原来的文件夹重命名为新的名称

│       ├── 4.社团文化衫/

│       ├── 6.30天开发卡片/#### 运行方法

│       └── 8.文博会网约车/

│

└── 📋待处理/              # 材料准备不为'yes'

    ├── 张大佑/**选项1: 双击运行**

    │   ├── 2.30天开发结题证书打印/  ← Excel第2行

    │   ├── 5.30天开发立牌/         ← Excel第5行```### 安装依赖### 4. 🔍 唯一ID追踪系统  - 保留文件夹中的所有文件

    │   ├── 7.30天开发证书框/       ← Excel第7行

    │   ├── 9.UE插件-BP2AI/双击 → 运行一次.bat

    │   ├── 10.夸克网盘/

    │   ├── 11.阿里云服务器/```

    │   └── ...

    └── 杨杰翔/

        └── 20.文博会网约车/        ← Excel第20行

```**选项2: 命令行**```bash- 为每一行数据生成唯一ID  - **不会创建新的文件夹!**



**行号说明**: 文件夹名称中的数字对应Excel中的实际行号(从第2行开始,第1行是标题)```bash



---python create_folders.pypip install pandas openpyxl watchdog



## 使用场景示例```



### 场景1: 批量录入新数据```- 支持新增、修改、删除行



**步骤:**---

1. 🚀 启动自动监控

2. 📝 打开Excel,逐行录入数据

3. 💾 保存Excel

4. 📝 继续录入下一批## 智能等待功能

5. 💾 保存Excel

6. ✅ 完成所有录入后关闭Excel### 第一次使用- 智能匹配现有记录**示例:**

7. 🎯 系统自动执行脚本

8. 👀 查看监控窗口确认结果### 功能说明



**优势:** 专注于数据录入,不用频繁等待



### 场景2: 快速定位文件夹 ⭐NEW系统会智能检测Excel文件是否被关闭,避免文件被占用导致执行失败。



**步骤:**1. 将 `社团报销.xlsx` 放在工作目录- 原来: `张大佑/打印30天结题证书`

1. 在Excel中看到第15行需要处理

2. 打开文件管理器,按名称排序### 工作模式

3. 直接找到 `15.NGJ路演打车2/` 文件夹

4. 处理完成!2. 双击运行 `启动自动监控.bat` (推荐) 或 `运行一次.bat`



**优势:** #### 模式A: 保存即关闭 (立即执行)

- 不用一个个翻找文件夹

- 行号直接对应,秒速定位3. 系统会自动:### 5. 🗑️ 智能删除- 修改 Excel 中的"开票内容"为: "打印60天结题证书"

- 效率提升10倍!

```

### 场景3: 完成材料收集(状态迁移)

编辑Excel → 保存(Ctrl+S) → 关闭Excel   - 创建 `✅已完成/` 和 `📋待处理/` 文件夹

**步骤:**

1. 文件夹位置: `📋待处理/张大佑/2.打印证书/`                              ↓

2. 收集完所有材料(≥3个文件)

3. 在Excel中将"材料准备"改为 `yes`                         检测到关闭   - 根据状态分类存放所有文件夹- 删除Excel行后,空文件夹自动删除- 运行脚本后: 文件夹自动重命名为 `张大佑/打印60天结题证书`

4. 保存并关闭Excel

5. 结果:                              ↓

   ```

   📦 移动文件夹:                         立即执行脚本   - 添加"唯一ID"和"文件数量"列到Excel

      从: 📋待处理\张大佑\2.打印证书

      到: ✅已完成\张大佑\2.打印证书                              ↓

   

   📊 统计信息:                         完成!   - 生成元数据文件- 有文件的文件夹自动保留(防止误删)- 文件夹中的文件保持不变!

      ✅已完成: 5 个文件夹

      📋待处理: 25 个文件夹```

      📦移动: 1 个文件夹

   ```   - 检测文件数量并更新状态

6. 现在只需要查看 `📋待处理/` 就知道还有哪些没完成!

⏱️ **执行时机**: 关闭Excel后立即执行

### 场景4: 调整Excel行顺序 ⭐NEW

- 空的付款人文件夹也会被清理

**步骤:**

1. Excel中第5行移动到第3行#### 模式B: 保存后继续编辑 (延迟执行)

2. 保存Excel

3. 结果:---

   - 原第5行的文件夹: `5.xxx` → `3.xxx`

   - 原第3行的文件夹: `3.xxx` → `4.xxx````

   - 原第4行的文件夹: `4.xxx` → `5.xxx`

4. 文件夹顺序与Excel完全同步!打开Excel### 4. 自动检测文件数量



### 场景5: 查看文件数量统计   ↓



运行脚本后查看统计:修改 → 保存 → 继续修改 → 保存 → 关闭Excel## 使用方法



```       ↓               ↓          ↓

📊 统计信息:

   ✅已完成: 4 个文件夹   等待关闭...     等待关闭...  立即执行!### 6. 👁️ 自动监控 (推荐)- 检测每个文件夹中的文件数量

   📋待处理: 26 个文件夹

   📦移动: 30 个文件夹```

   ✨新建: 0 个文件夹

```### 方式一:自动监控(推荐) 🎯



在Excel中直接查看"文件数量"列:⏱️ **执行时机**: 最后关闭Excel时才执行



| 行号 | 付款人 | 开票内容 | 材料准备 | 文件数量 |✅ **优势**: 可以连续编辑,不用每次等待- 实时监控Excel文件变化- 自动更新 Excel 中的"材料准备"列:

|------|--------|----------|----------|----------|

| 2    | 张大佑 | 打印证书 | no       | 1        |

| 3    | 张大佑 | 招新传单 | yes      | 3        |

| 8    | 张大佑 | 网约车   | yes      | 10       |---**适合频繁修改Excel时使用**



---



## 常见问题## 主要操作- 保存后自动执行脚本  - 文件数 < 3: 设置为 `no` (材料不足)



### Q: 行号前缀有什么用?



**A:** ### 新增记录#### 启动方法

- ✅ 在文件管理器中按名称排序,文件夹顺序与Excel完全一致

- ✅ 看到Excel第15行有问题,直接找 `15.xxx` 文件夹

- ✅ 不用一个个翻找,秒速定位

1. 在Excel末尾添加新行- 智能等待Excel关闭后再执行  - 文件数 ≥ 3 且状态不是 `yes`: 设置为 `check` (需要人工检查)

### Q: 调整Excel行顺序后,行号会自动更新吗?

2. 填写"付款人"、"开票内容"和"材料准备"

**A:** ✅ 会!系统会自动检测行号变化并重命名文件夹,保持与Excel一致。

3. **"唯一ID"和"文件数量"列留空**(系统自动生成)**选项1: 双击启动** (最简单)

### Q: 为什么要分成两个文件夹?

4. 保存Excel(如使用监控)或运行脚本

**A:** 这样你可以:

- 快速找到还没处理完的文件夹(只看 `📋待处理/`)5. 结果:```  - 文件数 ≥ 3 且状态是 `yes`: 保持 `yes` 不变

- 清楚知道哪些已经完成了(在 `✅已完成/`)

- 提高工作效率,不用翻找整个文件夹   - ✅ 自动生成唯一ID



### Q: 改变状态后文件会丢失吗?   - ✅ 根据"材料准备"状态创建到对应文件夹双击 → 启动自动监控.bat



**A:** ❌ 不会!系统使用 `shutil.move()` 移动文件夹,会保留所有文件和子文件夹。   - ✅ 文件夹名称自动添加Excel行号



### Q: 可以手动修改文件夹名称吗?   - ✅ 自动统计文件数量```---



**A:** ⚠️ 不建议!应该通过修改Excel来触发自动重命名,这样:   - ✅ 保存元数据

- 行号前缀会自动更新

- 元数据能保持同步

- 避免出现不一致

### 修改记录

### Q: 为什么要等文件关闭才执行?

**选项2: 命令行启动**## 使用方法

**A:** 当Excel打开文件时,文件被锁定,脚本无法:

- 正确读取最新数据1. 在Excel中修改"开票内容"、"付款人"或"材料准备"

- 添加或更新"唯一ID"和"文件数量"列

- 保存修改后的Excel2. **不要修改"唯一ID"和"文件数量"列!**```bash



等待文件关闭后执行,确保操作成功。3. 保存Excel(如使用监控)或运行脚本



### Q: 可以手动修改唯一ID吗?4. 结果:python auto_watch.py## 快速开始



**A:** ❌ 不建议!唯一ID是系统识别记录的关键,修改可能导致:   - ✅ 文件夹自动重命名

- 系统认为是新记录,创建新文件夹

- 原文件夹变成"孤儿"   - ✅ 状态改变时自动迁移文件夹```



### Q: 文件数量列可以手动修改吗?   - ✅ 文件夹中的文件完整保留



**A:** ⚠️ 不建议!文件数量是系统自动统计的,手动修改会在下次运行时被覆盖。   - ✅ 元数据自动更新### 方式一:自动监控(推荐) 🎯



### Q: 可以在Excel中调整行的顺序吗?



**A:** ✅ 完全可以!系统会自动更新文件夹的行号前缀,保持与Excel同步。### 调整行顺序 ⭐NEW#### 工作流程



---



## 注意事项1. 在Excel中移动某行到其他位置### 安装依赖



### ⚠️ 重要提示2. 保存Excel



1. **不要手动修改"唯一ID"和"文件数量"列**3. 结果:```

   - 这些由系统自动管理

   - 手动修改会导致数据错误   ```



2. **不要手动重命名文件夹**   📦 移动文件夹:1. 启动监控(保持窗口打开)**适合频繁修改Excel时使用**

   - 应通过修改Excel后运行脚本来重命名

   - 手动重命名会导致行号不一致      从: 📋待处理\张大佑\5.打印证书

   - 元数据无法正确追踪

      到: 📋待处理\张大佑\3.打印证书   ↓

3. **不要手动修改元数据文件**

   - `folder_metadata.json` 由系统自动管理   ```

   - 手动修改可能导致数据错误

4. 行号自动更新,文件夹顺序与Excel一致!2. 打开Excel,编辑数据```bash

4. **不要手动移动文件夹**

   - 应通过修改Excel后运行脚本来移动

   - 手动移动会导致系统无法追踪

### 改变状态(触发迁移)   ↓

5. **不要直接删除状态文件夹**

   - `✅已完成/` 和 `📋待处理/` 是系统管理的

   - 删除后会自动重新创建

**示例: 将材料从待处理改为已完成**3. 保存Excel (Ctrl+S)pip install pandas openpyxl watchdog1. 双击运行 `启动自动监控.bat`

6. **删除行的影响**

   - 空文件夹会被自动删除

   - 有文件的文件夹会被保留

   - 其他文件夹的行号会自动更新1. 收集完报销材料后,将"材料准备"改为 `yes`   ↓



7. **监控窗口的使用**2. 保存Excel

   - 使用自动监控时,窗口必须保持打开

   - 可以最小化,但不要关闭3. 结果:4. 继续编辑... (可选)```2. 保持监控窗口打开(可最小化)

   - 关闭窗口会停止监控

   ```

### 📊 状态说明

   📦 移动文件夹:   ↓

| 状态 | 含义 | 文件夹位置 | 触发条件 |

|------|------|-----------|----------|      从: 📋待处理\张大佑\2.打印证书

| `no` | 材料不足 | 📋待处理/ | 文件数 < 3 |

| `check` | 需要检查 | 📋待处理/ | 文件数 ≥ 3,但未审核 |      到: ✅已完成\张大佑\2.打印证书5. 关闭Excel3. 正常编辑和保存Excel文件

| `yes` | 已确认通过 | ✅已完成/ | 人工审核后标记 |

   ```

### 🔄 工作流程建议

4. 文件夹中的所有文件完整保留!   ↓

1. 📝 在Excel中记录报销信息

2. 🚀 运行脚本创建文件夹(位于 `📋待处理/`)

3. 📂 根据行号快速定位并放入报销材料

4. 🔍 再次运行脚本检查材料收集进度### 删除记录6. 🎯 系统自动执行脚本### 第一次使用4. 每次保存后会自动执行脚本

5. ✅ 状态为`check`的需人工审核

6. 🎯 审核通过后手动将状态改为`yes`

7. 📦 文件夹自动移动到 `✅已完成/`

1. 在Excel中删除某一行   ↓

---

2. 保存Excel(如使用监控)或运行脚本

## 效率提升

3. 结果:7. 查看监控窗口中的结果5. 完成后关闭监控窗口

### 传统方式:

   - ✅ 空文件夹自动删除

```

查找文件夹: 翻找多个文件夹 → 不确定是哪个 → 一个个打开查看   - ⚠️ 有文件的文件夹保留并提示```

           ↑_______浪费大量时间_______↑

```   - ✅ 空的付款人文件夹也被删除



⏱️ 找一个文件夹可能需要1-2分钟   - ✅ 元数据标记为已删除1. 将 `社团报销.xlsx` 放在工作目录



### 使用行号排序:   - ✅ 其他文件夹的行号自动更新



```#### 监控窗口示例

查看Excel: 第15行有问题

           ↓---

打开文件夹: 直接找 "15.xxx"

           ↓2. 双击运行 `启动自动监控.bat` (推荐) 或 `运行一次.bat`详细说明请查看: [自动监控说明.md](自动监控说明.md)

完成: 3秒定位!

```## 文件说明



⏱️ 秒速定位,效率提升20倍!```



### 使用智能分类后:### 主要文件



```============================================================3. 系统会自动:

查看进度: 只看 📋待处理/ 文件夹

完成情况: 查看 ✅已完成/ 统计数量| 文件名 | 说明 | 是否必需 |

快速定位: 根据行号秒速找到文件夹

```|--------|------|---------|📂 社团报销自动化监控系统



⏱️ 不用翻找,一目了然!| `社团报销.xlsx` | Excel数据源 | ✅ 必需 |



**总体效率提升**: 结合自动监控、智能分类和行号排序,工作效率提升10-20倍!| `create_folders.py` | 主程序脚本 | ✅ 必需 |============================================================   - 创建所有文件夹### 方式二:手动运行



---| `auto_watch.py` | 自动监控脚本 | ⭐ 推荐 |



## 技术栈| `启动自动监控.bat` | 一键启动监控 | ⭐ 推荐 |📁 监控目录: C:\Users\Dau\Desktop\社团报销



- **Python 3.7+**: 主要编程语言| `运行一次.bat` | 手动运行一次 | 可选 |

- **pandas**: Excel文件读写

- **openpyxl**: Excel操作库| `folder_metadata.json` | 元数据(自动生成) | 🚫 勿修改 |📊 监控文件: 社团报销.xlsx   - 添加"唯一ID"列到Excel

- **watchdog**: 文件监控

- **pathlib**: 文件路径处理

- **shutil**: 文件夹移动操作

### 文件夹结构 ⭐NEW🔧 执行脚本: create_folders.py

---



## 更新日志

```============================================================   - 生成元数据文件**适合偶尔更新时使用**

### v3.1 (2025-01-17) ⭐NEW

- ✨ 新增行号前缀功能社团报销/

- ✨ 文件夹名称自动与Excel行号同步

- ✨ 调整Excel行顺序时自动更新行号├── 社团报销.xlsx           # Excel数据源

- ✨ 增强清理机制,自动清理未追踪的嵌套文件夹

- 🎨 优化文件夹排序,与Excel完全一致├── create_folders.py       # 主程序

- 🐛 修复"血与火"文件夹清理问题

- 📝 更新文档说明├── auto_watch.py          # 监控脚本✅ 监控已启动!   - 检测文件数量并更新状态



### v3.0 (2025-01-17)├── 启动自动监控.bat       # 启动文件

- ✨ 新增智能分类功能(✅已完成/📋待处理)

- ✨ 新增自动状态迁移功能├── 运行一次.bat           # 手动运行💡 提示: 每次保存Excel文件后会自动执行脚本

- ✨ 新增文件数量统计列

- ✨ 新增统计信息展示├── folder_metadata.json   # 元数据

- 🎨 优化文件夹结构,更直观

- 📝 更新文档说明├── README.md             # 本文档⚠️  按 Ctrl+C 可以停止监控```bash



### v2.0 (2024-11-17)│

- ✨ 新增自动监控功能

- ✨ 新增智能等待Excel关闭功能├── ✅已完成/              # 材料准备为'yes'```

- ✨ 新增智能删除空文件夹功能

- ✨ 新增唯一ID追踪系统│   └── 张大佑/

- 🐛 修复Windows命令行编码问题

- 📝 完善文档说明│       ├── 3.社团招新传单/    ← 行号前缀---python create_folders.py



### v1.0 (2024-11-17)│       │   ├── 发票.pdf

- 🎉 首次发布

- ✨ 基础文件夹创建功能│       │   ├── 截图.png#### 停止监控

- ✨ 文件数量检测功能

- ✨ 智能重命名功能│       │   └── 证明.jpg



---│       ├── 4.社团文化衫/```



**享受自动化的便利!** 🎉│       ├── 6.30天开发卡片/


│       └── 8.文博会网约车/- 关闭监控窗口

│

└── 📋待处理/              # 材料准备不为'yes'- 或按 `Ctrl+C`## 使用方法

    ├── 张大佑/

    │   ├── 2.30天开发结题证书打印/  ← Excel第2行

    │   ├── 5.30天开发立牌/         ← Excel第5行

    │   ├── 7.30天开发证书框/       ← Excel第7行### 方式二:手动运行### 第一次运行

    │   ├── 9.UE插件-BP2AI/

    │   ├── 10.夸克网盘/

    │   ├── 11.阿里云服务器/

    │   └── ...**适合偶尔更新时使用**### 方式一:自动监控(推荐) 🎯无论使用哪种方式,第一次运行会:

    └── 杨杰翔/

        └── 20.文博会网约车/        ← Excel第20行

```

#### 运行方法- 创建所有文件夹

**行号说明**: 文件夹名称中的数字对应Excel中的实际行号(从第2行开始,第1行是标题)



---

**选项1: 双击运行****适合频繁修改Excel时使用**- 在 Excel 中自动添加"唯一ID"列

## 使用场景示例

```

### 场景1: 批量录入新数据

双击 → 运行一次.bat- 为每一行生成唯一ID

**步骤:**

1. 🚀 启动自动监控```

2. 📝 打开Excel,逐行录入数据

3. 💾 保存Excel#### 启动方法- 生成 `folder_metadata.json` 元数据文件

4. 📝 继续录入下一批

5. 💾 保存Excel**选项2: 命令行**

6. ✅ 完成所有录入后关闭Excel

7. 🎯 系统自动执行脚本```bash- 更新 Excel 文件中的"材料准备"列

8. 👀 查看监控窗口确认结果

python create_folders.py

**优势:** 专注于数据录入,不用频繁等待

```**选项1: 双击启动** (最简单)

### 场景2: 快速定位文件夹 ⭐NEW



**步骤:**

1. 在Excel中看到第15行需要处理---```### 修改开票内容后运行

2. 打开文件管理器,按名称排序

3. 直接找到 `15.NGJ路演打车2/` 文件夹

4. 处理完成!

## 智能等待功能双击 → 启动自动监控.bat1. 在 Excel 中修改某一行的"开票内容"(不要修改"唯一ID"列!)

**优势:** 

- 不用一个个翻找文件夹

- 行号直接对应,秒速定位

- 效率提升10倍!### 功能说明```2. 保存 Excel 文件



### 场景3: 完成材料收集(状态迁移)



**步骤:**系统会智能检测Excel文件是否被关闭,避免文件被占用导致执行失败。3. 再次运行脚本:

1. 文件夹位置: `📋待处理/张大佑/2.打印证书/`

2. 收集完所有材料(≥3个文件)

3. 在Excel中将"材料准备"改为 `yes`

4. 保存并关闭Excel### 工作模式**选项2: 命令行启动**```bash

5. 结果:

   ```

   📦 移动文件夹:

      从: 📋待处理\张大佑\2.打印证书#### 模式A: 保存即关闭 (立即执行)```bashpython create_folders.py

      到: ✅已完成\张大佑\2.打印证书

   

   📊 统计信息:

      ✅已完成: 5 个文件夹```python auto_watch.py```

      📋待处理: 25 个文件夹

      📦移动: 1 个文件夹编辑Excel → 保存(Ctrl+S) → 关闭Excel

   ```

6. 现在只需要查看 `📋待处理/` 就知道还有哪些没完成!                              ↓```4. 脚本会自动识别变化并重命名对应的文件夹



### 场景4: 调整Excel行顺序 ⭐NEW                         检测到关闭



**步骤:**                              ↓

1. Excel中第5行移动到第3行

2. 保存Excel                         立即执行脚本

3. 结果:

   - 原第5行的文件夹: `5.xxx` → `3.xxx`                              ↓#### 工作流程### 添加新行 ✨

   - 原第3行的文件夹: `3.xxx` → `4.xxx`

   - 原第4行的文件夹: `4.xxx` → `5.xxx`                         完成!

4. 文件夹顺序与Excel完全同步!

```1. 直接在 Excel 中添加新行(付款人和开票内容)

### 场景5: 查看文件数量统计



运行脚本后查看统计:

⏱️ **执行时机**: 关闭Excel后立即执行```2. **不需要填写"唯一ID"列**,留空即可

```

📊 统计信息:

   ✅已完成: 4 个文件夹

   📋待处理: 26 个文件夹#### 模式B: 保存后继续编辑 (延迟执行)1. 启动监控(保持窗口打开)3. 运行脚本:

   📦移动: 30 个文件夹

   ✨新建: 0 个文件夹

```

```   ↓   - 自动为新行生成唯一ID

在Excel中直接查看"文件数量"列:

打开Excel

| 行号 | 付款人 | 开票内容 | 材料准备 | 文件数量 |

|------|--------|----------|----------|----------|   ↓2. 打开Excel,编辑数据   - 创建对应的文件夹

| 2    | 张大佑 | 打印证书 | no       | 1        |

| 3    | 张大佑 | 招新传单 | yes      | 3        |修改 → 保存 → 继续修改 → 保存 → 关闭Excel

| 8    | 张大佑 | 网约车   | yes      | 10       |

       ↓               ↓          ↓   ↓   - 保存元数据

---

   等待关闭...     等待关闭...  立即执行!

## 常见问题

```3. 保存Excel (Ctrl+S)

### Q: 行号前缀有什么用?



**A:** 

- ✅ 在文件管理器中按名称排序,文件夹顺序与Excel完全一致⏱️ **执行时机**: 最后关闭Excel时才执行   ↓### 删除行 ✨

- ✅ 看到Excel第15行有问题,直接找 `15.xxx` 文件夹

- ✅ 不用一个个翻找,秒速定位✅ **优势**: 可以连续编辑,不用每次等待



### Q: 调整Excel行顺序后,行号会自动更新吗?4. 继续编辑... (可选)1. 在 Excel 中删除某一行



**A:** ✅ 会!系统会自动检测行号变化并重命名文件夹,保持与Excel一致。### 等待提示



### Q: 为什么要分成两个文件夹?   ↓2. 保存 Excel 文件



**A:** 这样你可以:当文件被占用时,监控窗口会显示:

- 快速找到还没处理完的文件夹(只看 `📋待处理/`)

- 清楚知道哪些已经完成了(在 `✅已完成/`)5. 关闭Excel3. 运行脚本:

- 提高工作效率,不用翻找整个文件夹

```

### Q: 改变状态后文件会丢失吗?

⏳ 检测到Excel文件正在使用中,等待文件关闭...   ↓   - 自动检测已删除的记录

**A:** ❌ 不会!系统使用 `shutil.move()` 移动文件夹,会保留所有文件和子文件夹。

💡 提示: 请在Excel中关闭文件后,脚本会自动执行

### Q: 可以手动修改文件夹名称吗?

6. 🎯 系统自动执行脚本   - **空文件夹会被自动删除**

**A:** ⚠️ 不建议!应该通过修改Excel来触发自动重命名,这样:

- 行号前缀会自动更新⏳ 仍在等待... (5/60秒)

- 元数据能保持同步

- 避免出现不一致⏳ 仍在等待... (10/60秒)   ↓   - **有文件的文件夹会被保留**(防止误删)



### Q: 为什么要等文件关闭才执行?



**A:** 当Excel打开文件时,文件被锁定,脚本无法:[你关闭了Excel]7. 查看监控窗口中的结果   - 显示文件夹状态和文件数量

- 正确读取最新数据

- 添加或更新"唯一ID"和"文件数量"列

- 保存修改后的Excel

✅ 文件已关闭 (等待了 12 秒)```   - 元数据中标记为已删除(可恢复)

等待文件关闭后执行,确保操作成功。

🚀 正在执行文件夹创建脚本...

### Q: 可以手动修改唯一ID吗?

```

**A:** ❌ 不建议!唯一ID是系统识别记录的关键,修改可能导致:

- 系统认为是新记录,创建新文件夹

- 原文件夹变成"孤儿"

---#### 监控窗口示例## 文件说明

### Q: 文件数量列可以手动修改吗?



**A:** ⚠️ 不建议!文件数量是系统自动统计的,手动修改会在下次运行时被覆盖。

## 主要操作

### Q: 可以在Excel中调整行的顺序吗?



**A:** ✅ 完全可以!系统会自动更新文件夹的行号前缀,保持与Excel同步。

### 新增记录```- `社团报销.xlsx` - Excel 数据源文件

---



## 注意事项

1. 在Excel末尾添加新行============================================================- `create_folders.py` - 主程序脚本

### ⚠️ 重要提示

2. 填写"付款人"、"开票内容"和"材料准备"

1. **不要手动修改"唯一ID"和"文件数量"列**

   - 这些由系统自动管理3. **"唯一ID"和"文件数量"列留空**(系统自动生成)📂 社团报销自动化监控系统- `auto_watch.py` - 自动监控脚本 ✨

   - 手动修改会导致数据错误

4. 保存Excel(如使用监控)或运行脚本

2. **不要手动重命名文件夹**

   - 应通过修改Excel后运行脚本来重命名5. 结果:============================================================- `启动自动监控.bat` - 一键启动监控 ✨

   - 手动重命名会导致行号不一致

   - 元数据无法正确追踪   - ✅ 自动生成唯一ID



3. **不要手动修改元数据文件**   - ✅ 根据"材料准备"状态创建到对应文件夹📁 监控目录: C:\Users\Dau\Desktop\社团报销- `folder_metadata.json` - 元数据文件(自动生成,请勿手动修改)

   - `folder_metadata.json` 由系统自动管理

   - 手动修改可能导致数据错误   - ✅ 自动统计文件数量



4. **不要手动移动文件夹**   - ✅ 保存元数据📊 监控文件: 社团报销.xlsx- 各文件夹 - 存储对应报销材料的文件

   - 应通过修改Excel后运行脚本来移动

   - 手动移动会导致系统无法追踪



5. **不要直接删除状态文件夹**### 修改记录🔧 执行脚本: create_folders.py- `README.md` - 主要说明文档

   - `✅已完成/` 和 `📋待处理/` 是系统管理的

   - 删除后会自动重新创建



6. **删除行的影响**1. 在Excel中修改"开票内容"、"付款人"或"材料准备"============================================================- `自动监控说明.md` - 自动监控详细说明 ✨

   - 空文件夹会被自动删除

   - 有文件的文件夹会被保留2. **不要修改"唯一ID"和"文件数量"列!**

   - 其他文件夹的行号会自动更新

3. 保存Excel(如使用监控)或运行脚本- `使用场景示例.md` - 各种使用场景的详细示例

7. **监控窗口的使用**

   - 使用自动监控时,窗口必须保持打开4. 结果:

   - 可以最小化,但不要关闭

   - 关闭窗口会停止监控   - ✅ 文件夹自动重命名✅ 监控已启动!



### 📊 状态说明   - ✅ 状态改变时自动迁移文件夹



| 状态 | 含义 | 文件夹位置 | 触发条件 |   - ✅ 文件夹中的文件完整保留💡 提示: 每次保存Excel文件后会自动执行脚本## 注意事项

|------|------|-----------|----------|

| `no` | 材料不足 | 📋待处理/ | 文件数 < 3 |   - ✅ 元数据自动更新

| `check` | 需要检查 | 📋待处理/ | 文件数 ≥ 3,但未审核 |

| `yes` | 已确认通过 | ✅已完成/ | 人工审核后标记 |⚠️  按 Ctrl+C 可以停止监控



### 🔄 工作流程建议### 改变状态(触发迁移) ⭐NEW



1. 📝 在Excel中记录报销信息```⚠️ **重要提示:**

2. 🚀 运行脚本创建文件夹(位于 `📋待处理/`)

3. 📂 根据行号快速定位并放入报销材料**示例: 将材料从待处理改为已完成**

4. 🔍 再次运行脚本检查材料收集进度

5. ✅ 状态为`check`的需人工审核1. **不要手动修改或删除 Excel 中的"唯一ID"列!** 这是系统识别每一行的关键

6. 🎯 审核通过后手动将状态改为`yes`

7. 📦 文件夹自动移动到 `✅已完成/`1. 收集完报销材料后,将"材料准备"改为 `yes`



---2. 保存Excel#### 停止监控2. 不要手动删除或修改 `folder_metadata.json` 文件



## 效率提升3. 结果:



### 传统方式:   ```3. 不要手动重命名已创建的文件夹,应通过修改 Excel 后运行脚本来重命名



```   📦 移动文件夹:

查找文件夹: 翻找多个文件夹 → 不确定是哪个 → 一个个打开查看

           ↑_______浪费大量时间_______↑      从: 📋待处理\张大佑\打印证书- 关闭监控窗口4. **删除行后,空文件夹会被自动删除,有文件的文件夹会被保留**

```

      到: ✅已完成\张大佑\打印证书

⏱️ 找一个文件夹可能需要1-2分钟

   ```- 或按 `Ctrl+C`5. 如果元数据文件损坏,删除它后重新运行脚本会重新创建

### 使用行号排序:

4. 文件夹中的所有文件完整保留!

```

查看Excel: 第15行有问题

           ↓

打开文件夹: 直接找 "15.xxx"### 删除记录

           ↓

完成: 3秒定位!### 方式二:手动运行## 唯一ID系统

```

1. 在Excel中删除某一行

⏱️ 秒速定位,效率提升20倍!

2. 保存Excel(如使用监控)或运行脚本

### 使用智能分类后:

3. 结果:

```

查看进度: 只看 📋待处理/ 文件夹   - ✅ 空文件夹自动删除**适合偶尔更新时使用**系统使用"唯一ID"列来追踪每一行记录:

完成情况: 查看 ✅已完成/ 统计数量

快速定位: 根据行号秒速找到文件夹   - ⚠️ 有文件的文件夹保留并提示

```

   - ✅ 空的付款人文件夹也被删除

⏱️ 不用翻找,一目了然!

   - ✅ 元数据标记为已删除

**总体效率提升**: 结合自动监控、智能分类和行号排序,工作效率提升10-20倍!

#### 运行方法- **自动生成**: 新增行时留空,脚本会自动生成唯一ID

---

---

## 技术栈

- **持久化**: 即使修改"开票内容"或"付款人",只要ID不变,就会识别为同一条记录

- **Python 3.7+**: 主要编程语言

- **pandas**: Excel文件读写## 文件说明

- **openpyxl**: Excel操作库

- **watchdog**: 文件监控**选项1: 双击运行**- **智能匹配**: 如果ID丢失,系统会尝试通过付款人和内容匹配现有记录

- **pathlib**: 文件路径处理

- **shutil**: 文件夹移动操作### 主要文件



---```- **删除检测**: 通过对比Excel和元数据中的ID,检测被删除的记录



## 更新日志| 文件名 | 说明 | 是否必需 |



### v3.1 (2025-01-17) ⭐NEW|--------|------|---------|双击 → 运行一次.bat

- ✨ 新增行号前缀功能

- ✨ 文件夹名称自动与Excel行号同步| `社团报销.xlsx` | Excel数据源 | ✅ 必需 |

- ✨ 调整Excel行顺序时自动更新行号

- 🎨 优化文件夹排序,与Excel完全一致| `create_folders.py` | 主程序脚本 | ✅ 必需 |```## 工作流程建议

- 📝 更新文档说明

| `auto_watch.py` | 自动监控脚本 | ⭐ 推荐 |

### v3.0 (2025-01-17)

- ✨ 新增智能分类功能(✅已完成/📋待处理)| `启动自动监控.bat` | 一键启动监控 | ⭐ 推荐 |

- ✨ 新增自动状态迁移功能

- ✨ 新增文件数量统计列| `运行一次.bat` | 手动运行一次 | 可选 |

- ✨ 新增统计信息展示

- 🎨 优化文件夹结构,更直观| `folder_metadata.json` | 元数据(自动生成) | 🚫 勿修改 |**选项2: 命令行**1. 在 Excel 中记录报销信息

- 📝 更新文档说明



### v2.0 (2024-11-17)

- ✨ 新增自动监控功能### 文件夹结构 ⭐NEW```bash2. 运行脚本创建/更新文件夹

- ✨ 新增智能等待Excel关闭功能

- ✨ 新增智能删除空文件夹功能

- ✨ 新增唯一ID追踪系统

- 🐛 修复Windows命令行编码问题```python create_folders.py3. 将报销材料(发票、截图等)放入对应文件夹

- 📝 完善文档说明

社团报销/

### v1.0 (2024-11-17)

- 🎉 首次发布├── 社团报销.xlsx           # Excel数据源```4. 再次运行脚本检查材料收集进度

- ✨ 基础文件夹创建功能

- ✨ 文件数量检测功能├── create_folders.py       # 主程序

- ✨ 智能重命名功能

├── auto_watch.py          # 监控脚本5. 状态为 `check` 的条目需要人工审核

---

├── 启动自动监控.bat       # 启动文件

**享受自动化的便利!** 🎉

├── 运行一次.bat           # 手动运行---6. 审核通过后手动将 Excel 中的状态改为 `yes`

├── folder_metadata.json   # 元数据

├── README.md             # 本文档

│

├── ✅已完成/              # 材料准备为'yes'## 智能等待功能## 状态说明

│   └── 张大佑/

│       ├── 社团招新传单/

│       │   ├── 发票.pdf

│       │   ├── 截图.png### 功能说明- `no` - 材料不足(文件数 < 3)

│       │   └── 证明.jpg

│       ├── 社团文化衫/- `check` - 需要检查(文件数 ≥ 3,但未审核)

│       └── 30天开发卡片/

│系统会智能检测Excel文件是否被关闭,避免文件被占用导致执行失败。- `yes` - 已确认通过(人工标记)

└── 📋待处理/              # 材料准备不为'yes'

    ├── 张大佑/

    │   ├── 打印证书/### 工作模式

    │   │   └── 发票.pdf

    │   ├── 购买设备/#### 模式A: 保存即关闭 (立即执行)

    │   └── 阿里云服务器/

    └── 杨杰翔/```

        └── 文博会网约车/编辑Excel → 保存(Ctrl+S) → 关闭Excel

```                              ↓

                         检测到关闭

---                              ↓

                         立即执行脚本

## 使用场景示例                              ↓

                         完成!

### 场景1: 批量录入新数据```



**步骤:**⏱️ **执行时机**: 关闭Excel后立即执行

1. 🚀 启动自动监控

2. 📝 打开Excel,逐行录入数据#### 模式B: 保存后继续编辑 (延迟执行)

3. 💾 保存Excel

4. 📝 继续录入下一批```

5. 💾 保存Excel打开Excel

6. ✅ 完成所有录入后关闭Excel   ↓

7. 🎯 系统自动执行脚本修改 → 保存 → 继续修改 → 保存 → 关闭Excel

8. 👀 查看监控窗口确认结果       ↓               ↓          ↓

   等待关闭...     等待关闭...  立即执行!

**优势:** 专注于数据录入,不用频繁等待```



### 场景2: 修改开票内容(重命名文件夹)⏱️ **执行时机**: 最后关闭Excel时才执行

✅ **优势**: 可以连续编辑,不用每次等待

**步骤:**

1. Excel中有一行: `付款人=张大佑, 开票内容=打印30天证书`### 等待提示

2. 修改为: `付款人=张大佑, 开票内容=打印60天证书`

3. **保持唯一ID不变**当文件被占用时,监控窗口会显示:

4. 保存Excel并关闭(如使用监控)

5. 结果:```

   ```⏳ 检测到Excel文件正在使用中,等待文件关闭...

   📝 移动文件夹:💡 提示: 请在Excel中关闭文件后,脚本会自动执行

      从: 📋待处理\张大佑\打印30天证书

      到: 📋待处理\张大佑\打印60天证书⏳ 仍在等待... (5/60秒)

   ```⏳ 仍在等待... (10/60秒)



### 场景3: 完成材料收集(状态迁移) ⭐NEW[你关闭了Excel]



**步骤:**✅ 文件已关闭 (等待了 12 秒)

1. 文件夹位置: `📋待处理/张大佑/打印证书/`🚀 正在执行文件夹创建脚本...

2. 收集完所有材料(≥3个文件)```

3. 在Excel中将"材料准备"改为 `yes`

4. 保存并关闭Excel---

5. 结果:

   ```## 主要操作

   📦 移动文件夹:

      从: 📋待处理\张大佑\打印证书### 新增记录

      到: ✅已完成\张大佑\打印证书

   1. 在Excel末尾添加新行

   📊 统计信息:2. 填写"付款人"和"开票内容"

      ✅已完成: 4 个文件夹3. **"唯一ID"列留空**(系统自动生成)

      📋待处理: 26 个文件夹4. 保存Excel(如使用监控)或运行脚本

      📦移动: 1 个文件夹5. 结果:

   ```   - ✅ 自动生成唯一ID

6. 现在只需要查看 `📋待处理/` 就知道还有哪些没完成!   - ✅ 创建对应文件夹

   - ✅ 保存元数据

### 场景4: 删除不需要的记录

### 修改记录

**步骤:**

1. 在Excel中删除某一行1. 在Excel中修改"开票内容"或"付款人"

2. 保存Excel并关闭(如使用监控)2. **不要修改"唯一ID"列!**

3. 结果 - 情况A(文件夹为空):3. 保存Excel(如使用监控)或运行脚本

   ```4. 结果:

   🗑️ 检测到 1 个已删除的记录:   - ✅ 文件夹自动重命名

      ID: xxx   - ✅ 文件夹中的文件保留

      付款人: 张大佑   - ✅ 元数据自动更新

      开票内容: 测试项目

      ✅ 文件夹为空,已删除### 删除记录

   ```

4. 结果 - 情况B(文件夹有文件):1. 在Excel中删除某一行

   ```2. 保存Excel(如使用监控)或运行脚本

   🗑️ 检测到 1 个已删除的记录:3. 结果:

      ID: xxx   - ✅ 空文件夹自动删除

      付款人: 张大佑   - ⚠️ 有文件的文件夹保留并提示

      开票内容: 打印证书   - ✅ 空的付款人文件夹也被删除

      ⚠️ 文件夹中还有 3 个文件,已保留   - ✅ 元数据标记为已删除

   ```

---

### 场景5: 查看文件数量统计 ⭐NEW

## 文件说明

运行脚本后查看统计:

### 主要文件

```

📊 统计信息:| 文件名 | 说明 | 是否必需 |

   ✅已完成: 3 个文件夹|--------|------|---------|

   📋待处理: 27 个文件夹| `社团报销.xlsx` | Excel数据源 | ✅ 必需 |

   📦移动: 0 个文件夹| `create_folders.py` | 主程序脚本 | ✅ 必需 |

   ✨新建: 0 个文件夹| `auto_watch.py` | 自动监控脚本 | ⭐ 推荐 |

```| `启动自动监控.bat` | 一键启动监控 | ⭐ 推荐 |

| `运行一次.bat` | 手动运行一次 | 可选 |

在Excel中直接查看"文件数量"列:| `folder_metadata.json` | 元数据(自动生成) | 🚫 勿修改 |



| 付款人 | 开票内容 | 材料准备 | 文件数量 |### 文件夹结构

|--------|----------|----------|----------|

| 张大佑 | 打印证书 | no       | 1        |```

| 张大佑 | 招新传单 | yes      | 3        |社团报销/

| 张大佑 | 网约车   | check    | 10       |├── 社团报销.xlsx           # Excel数据源

├── create_folders.py       # 主程序

---├── auto_watch.py          # 监控脚本

├── 启动自动监控.bat       # 启动文件

## 常见问题├── 运行一次.bat           # 手动运行

├── folder_metadata.json   # 元数据

### Q: 为什么要分成两个文件夹?├── README.md             # 本文档

│

**A:** 这样你可以:├── 张大佑/               # 付款人文件夹

- 快速找到还没处理完的文件夹(只看 `📋待处理/`)│   ├── 打印证书/         # 开票内容文件夹

- 清楚知道哪些已经完成了(在 `✅已完成/`)│   │   ├── 发票.pdf

- 提高工作效率,不用翻找整个文件夹│   │   ├── 截图.png

│   │   └── 证明.jpg

### Q: 改变状态后文件会丢失吗?│   └── 购买设备/

│       └── ...

**A:** ❌ 不会!系统使用 `shutil.move()` 移动文件夹,会保留所有文件和子文件夹。│

└── 李明/

### Q: 可以手动移动文件夹吗?    └── ...

```

**A:** ⚠️ 不建议!应该通过修改Excel中的"材料准备"列来触发自动迁移,这样元数据才能保持同步。

---

### Q: 为什么要等文件关闭才执行?

## 使用场景示例

**A:** 当Excel打开文件时,文件被锁定,脚本无法:

- 正确读取最新数据### 场景1: 批量录入新数据

- 添加或更新"唯一ID"和"文件数量"列

- 保存修改后的Excel**步骤:**

1. 🚀 启动自动监控

等待文件关闭后执行,确保操作成功。2. 📝 打开Excel,逐行录入数据

3. 💾 保存Excel

### Q: 可以手动修改唯一ID吗?4. 📝 继续录入下一批

5. 💾 保存Excel

**A:** ❌ 不建议!唯一ID是系统识别记录的关键,修改可能导致:6. ✅ 完成所有录入后关闭Excel

- 系统认为是新记录,创建新文件夹7. 🎯 系统自动执行脚本

- 原文件夹变成"孤儿"8. 👀 查看监控窗口确认结果



### Q: 文件数量列可以手动修改吗?**优势:** 专注于数据录入,不用频繁等待



**A:** ⚠️ 不建议!文件数量是系统自动统计的,手动修改会在下次运行时被覆盖。### 场景2: 修改开票内容(重命名文件夹)



### Q: 可以在Excel中调整行的顺序吗?**步骤:**

1. Excel中有一行: `付款人=张大佑, 开票内容=打印30天证书`

**A:** ✅ 完全可以!唯一ID跟着行移动,系统通过ID识别,不依赖行号。2. 修改为: `付款人=张大佑, 开票内容=打印60天证书`

3. **保持唯一ID不变**

---4. 保存Excel并关闭(如使用监控)

5. 结果:

## 注意事项   ```

   📝 重命名文件夹:

### ⚠️ 重要提示      从: 张大佑\打印30天证书

      到: 张大佑\打印60天证书

1. **不要手动修改"唯一ID"和"文件数量"列**   ```

   - 这些由系统自动管理

   - 手动修改会导致数据错误### 场景3: 删除不需要的记录



2. **不要手动修改元数据文件****步骤:**

   - `folder_metadata.json` 由系统自动管理1. 在Excel中删除某一行

   - 手动修改可能导致数据错误2. 保存Excel并关闭(如使用监控)

3. 结果 - 情况A(文件夹为空):

3. **不要手动移动文件夹**   ```

   - 应通过修改Excel后运行脚本来移动   🗑️ 检测到 1 个已删除的记录:

   - 手动移动会导致系统无法追踪      ID: xxx

      付款人: 张大佑

4. **不要直接删除状态文件夹**      开票内容: 测试项目

   - `✅已完成/` 和 `📋待处理/` 是系统管理的      ✅ 文件夹为空,已删除

   - 删除后会自动重新创建   ```

4. 结果 - 情况B(文件夹有文件):

5. **删除行的影响**   ```

   - 空文件夹会被自动删除   🗑️ 检测到 1 个已删除的记录:

   - 有文件的文件夹会被保留      ID: xxx

   - 可以手动清理后再次运行      付款人: 张大佑

      开票内容: 打印证书

6. **监控窗口的使用**      ⚠️ 文件夹中还有 3 个文件,已保留

   - 使用自动监控时,窗口必须保持打开   ```

   - 可以最小化,但不要关闭

   - 关闭窗口会停止监控### 场景4: 唯一ID丢失(智能恢复)



### 📊 状态说明**步骤:**

1. 不小心删除了"唯一ID"列

| 状态 | 含义 | 文件夹位置 | 触发条件 |2. 运行脚本

|------|------|-----------|----------|3. 结果:

| `no` | 材料不足 | 📋待处理/ | 文件数 < 3 |   ```

| `check` | 需要检查 | 📋待处理/ | 文件数 ≥ 3,但未审核 |   🔗 第 3 行找到匹配的记录,使用ID: xxx

| `yes` | 已确认通过 | ✅已完成/ | 人工审核后标记 |   使用现有文件夹: 张大佑\打印招新传单

   ```

### 🔄 工作流程建议   - ✅ 系统自动恢复唯一ID

   - ✅ 继续使用原文件夹

1. 📝 在Excel中记录报销信息

2. 🚀 运行脚本创建文件夹(位于 `📋待处理/`)---

3. 📂 将报销材料放入对应文件夹

4. 🔍 再次运行脚本检查材料收集进度## 常见问题

5. ✅ 状态为`check`的需人工审核

6. 🎯 审核通过后手动将状态改为`yes`### Q: 为什么要等文件关闭才执行?

7. 📦 文件夹自动移动到 `✅已完成/`

**A:** 当Excel打开文件时,文件被锁定,脚本无法:

---- 正确读取最新数据

- 添加或更新"唯一ID"列

## 效率提升- 保存修改后的Excel



### 之前的工作流程:等待文件关闭后执行,确保操作成功。



```### Q: 可以手动修改唯一ID吗?

编辑 → 保存 → 关闭 → 运行脚本 → 等待 → 打开 → 编辑 → ...

       ↑________需要等待每次执行________↑**A:** ❌ 不建议!唯一ID是系统识别记录的关键,修改可能导致:

```- 系统认为是新记录,创建新文件夹

- 原文件夹变成"孤儿"

⏱️ 每次修改都要等待

### Q: 删除行后又想恢复怎么办?

### 现在的工作流程(使用自动监控):

**A:** 

```1. 如果文件夹还在,直接在Excel中重新添加这一行(留空唯一ID)

编辑 → 保存 → 编辑 → 保存 → 编辑 → 关闭 → 自动执行2. 运行脚本,系统会智能匹配现有文件夹

       ↑_____可以连续编辑,不需要等待_____↑    ↑3. 自动生成新ID并关联

                                            只等一次!

```### Q: 可以在Excel中调整行的顺序吗?



⏱️ 只需要在最后等待一次**A:** ✅ 完全可以!唯一ID跟着行移动,系统通过ID识别,不依赖行号。



### 使用智能分类后:### Q: 为什么保存后没有自动执行?



```**A:** 可能的原因:

查看进度: 只看 📋待处理/ 文件夹1. 监控窗口已关闭

完成情况: 查看 ✅已完成/ 统计数量2. 文件仍在Excel中打开(检查监控窗口,会显示"等待文件关闭")

```3. Excel文件名不是"社团报销.xlsx"



⏱️ 不用翻找,一目了然!### Q: 多人协作时会有冲突吗?



**效率提升**: 多次修改场景下可节省大量等待时间!**A:** ⚠️ 需要注意:

- 每人修改不同的行 → 没问题

---- 多人同时修改同一行 → 以最后保存的为准

- 建议协调好,避免同时编辑同一条记录

## 技术栈

---

- **Python 3.7+**: 主要编程语言

- **pandas**: Excel文件读写## 注意事项

- **openpyxl**: Excel操作库

- **watchdog**: 文件监控### ⚠️ 重要提示

- **pathlib**: 文件路径处理

- **shutil**: 文件夹移动操作1. **不要手动修改"唯一ID"列**

   - 这是系统识别每一行的关键

---   - 修改会导致系统无法正确追踪



## 更新日志2. **不要手动修改元数据文件**

   - `folder_metadata.json` 由系统自动管理

### v3.0 (2025-01-17) ⭐NEW   - 手动修改可能导致数据错误

- ✨ 新增智能分类功能(✅已完成/📋待处理)

- ✨ 新增自动状态迁移功能3. **不要手动重命名文件夹**

- ✨ 新增文件数量统计列   - 应通过修改Excel后运行脚本来重命名

- ✨ 新增统计信息展示   - 手动重命名会导致系统无法追踪

- 🎨 优化文件夹结构,更直观

- 📝 更新文档说明4. **删除行的影响**

   - 空文件夹会被自动删除

### v2.0 (2024-11-17)   - 有文件的文件夹会被保留

- ✨ 新增自动监控功能   - 可以手动清理后再次运行

- ✨ 新增智能等待Excel关闭功能

- ✨ 新增智能删除空文件夹功能5. **监控窗口的使用**

- ✨ 新增唯一ID追踪系统   - 使用自动监控时,窗口必须保持打开

- 🐛 修复Windows命令行编码问题   - 可以最小化,但不要关闭

- 📝 完善文档说明   - 关闭窗口会停止监控



### v1.0 (2024-11-17)### 📊 状态说明

- 🎉 首次发布

- ✨ 基础文件夹创建功能| 状态 | 含义 | 触发条件 |

- ✨ 文件数量检测功能|------|------|----------|

- ✨ 智能重命名功能| `no` | 材料不足 | 文件数 < 3 |

| `check` | 需要检查 | 文件数 ≥ 3,但未审核 |

---| `yes` | 已确认通过 | 人工审核后标记 |



**享受自动化的便利!** 🎉### 🔄 工作流程建议


1. 📝 在Excel中记录报销信息
2. 🚀 运行脚本创建/更新文件夹
3. 📂 将报销材料放入对应文件夹
4. 🔍 再次运行脚本检查材料收集进度
5. ✅ 状态为`check`的需人工审核
6. 🎯 审核通过后手动将状态改为`yes`

---

## 效率提升

### 之前的工作流程:

```
编辑 → 保存 → 关闭 → 运行脚本 → 等待 → 打开 → 编辑 → ...
       ↑________需要等待每次执行________↑
```

⏱️ 每次修改都要等待

### 现在的工作流程(使用自动监控):

```
编辑 → 保存 → 编辑 → 保存 → 编辑 → 关闭 → 自动执行
       ↑_____可以连续编辑,不需要等待_____↑    ↑
                                            只等一次!
```

⏱️ 只需要在最后等待一次

**效率提升**: 多次修改场景下可节省大量等待时间!

---

## 技术栈

- **Python 3.7+**: 主要编程语言
- **pandas**: Excel文件读写
- **openpyxl**: Excel操作库
- **watchdog**: 文件监控
- **pathlib**: 文件路径处理

---

## 更新日志

### v2.0 (2025-11-17)
- ✨ 新增自动监控功能
- ✨ 新增智能等待Excel关闭功能
- ✨ 新增智能删除空文件夹功能
- ✨ 新增唯一ID追踪系统
- 🐛 修复Windows命令行编码问题
- 📝 完善文档说明

### v1.0 (2025-11-17)
- 🎉 首次发布
- ✨ 基础文件夹创建功能
- ✨ 文件数量检测功能
- ✨ 智能重命名功能

---

**享受自动化的便利!** 🎉
