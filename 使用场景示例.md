# 使用场景示例

## 场景1: 修改开票内容(重命名文件夹)

### 步骤:
1. Excel 中有一行数据:
   ```
   付款人: 张大佑
   开票内容: 打印30天结题证书
   唯一ID: 1763359655913_7861
   ```

2. 你想改成"打印60天结题证书",在 Excel 中修改:
   ```
   付款人: 张大佑
   开票内容: 打印60天结题证书  ← 修改这里
   唯一ID: 1763359655913_7861  ← 不要动这个!
   ```

3. 保存 Excel,运行脚本:
   ```bash
   python create_folders.py
   ```

4. 结果:
   ```
   📝 重命名文件夹:
      从: 张大佑\打印30天结题证书
      到: 张大佑\打印60天结题证书
   ```
   - 文件夹自动重命名
   - 文件夹中的文件保持不变
   - 元数据自动更新

---

## 场景2: 新增一行记录

### 步骤:
1. 在 Excel 末尾添加新行:
   ```
   付款人: 张大佑
   开票内容: 购买投影仪
   唯一ID: (留空)  ← 不需要填写!
   ```

2. 保存 Excel,运行脚本:
   ```bash
   python create_folders.py
   ```

3. 结果:
   ```
   ✨ 第 19 行生成新ID: 1763360123456_7890
   ✨ 创建新文件夹: 张大佑\购买投影仪
   ```
   - 自动生成唯一ID并填入Excel
   - 创建对应的文件夹
   - 保存元数据

---

## 场景3: 删除一行记录

### 步骤:
1. Excel 中有一行数据你不需要了:
   ```
   付款人: 张大佑
   开票内容: 文博会网约车
   唯一ID: 1763359655919_2739
   ```

2. 在 Excel 中删除这一行,保存

3. 运行脚本:
   ```bash
   python create_folders.py
   ```

4. 结果 - 情况A(文件夹为空):
   ```
   🗑️ 检测到 1 个已删除的记录:
      ID: 1763359655919_2739
      付款人: 张大佑
      开票内容: 文博会网约车
      文件夹: 张大佑\文博会网约车
      ✅ 文件夹为空,已删除
   ```
   - 空文件夹自动删除
   - 元数据标记为已删除

5. 结果 - 情况B(文件夹有文件):
   ```
   🗑️ 检测到 1 个已删除的记录:
      ID: 1763359655919_2739
      付款人: 张大佑
      开票内容: 文博会网约车
      文件夹: 张大佑\文博会网约车
      ⚠️ 文件夹中还有 3 个文件,已保留
   ```
   - 保留文件夹和文件(防止误删)
   - 显示文件数量供参考

---

## 场景4: 唯一ID丢失(智能恢复)

### 步骤:
1. 不小心删除了"唯一ID"列,或者复制粘贴时丢失了ID

2. Excel 中的数据变成:
   ```
   付款人: 张大佑
   开票内容: 打印招新传单
   唯一ID: (空)  ← ID丢失了!
   ```

3. 运行脚本:
   ```bash
   python create_folders.py
   ```

4. 结果:
   ```
   🔗 第 3 行找到匹配的记录,使用ID: 1763359655914_7079
   使用现有文件夹: 张大佑\打印招新传单
   ```
   - 系统通过付款人和开票内容找到匹配的元数据
   - 自动恢复唯一ID
   - 继续使用原来的文件夹

---

## 场景5: 批量整理(删除多行)

### 步骤:
1. Excel 中有很多测试数据需要清理

2. 删除多行后保存

3. 运行脚本:
   ```bash
   python create_folders.py
   ```

4. 结果:
   ```
   🗑️ 检测到 5 个已删除的记录:
   
   ID: xxx1
   文件夹: 张大佑\测试1
   ✅ 已删除空文件夹
   
   ID: xxx2
   文件夹: 张大佑\测试2
   ⚠️ 文件夹中还有 2 个文件,已保留
   
   ID: xxx3
   文件夹: 张大佑\测试3
   ✅ 已删除空文件夹
   
   ... (更多记录)
   ```
   - 批量处理删除的记录
   - 空文件夹自动删除
   - 有文件的保留并提示

---

## 常见问题

### Q: 可以手动修改唯一ID吗?
**A:** ❌ 不建议!唯一ID是系统识别记录的关键,修改可能导致:
- 系统认为是新记录,创建新文件夹
- 原文件夹变成"孤儿"

### Q: 删除行后又想恢复怎么办?
**A:** 
1. 如果文件夹还在,只需在Excel中重新添加这一行(留空唯一ID)
2. 运行脚本,系统会智能匹配现有文件夹
3. 自动生成新ID并关联

### Q: 可以在Excel中调整行的顺序吗?
**A:** ✅ 完全可以!唯一ID跟着行移动,系统通过ID识别,不依赖行号

### Q: 多人协作时会有冲突吗?
**A:** ⚠️ 需要注意:
- 每人修改不同的行 → 没问题
- 多人同时修改同一行 → 以最后保存的为准
- 建议协调好,避免同时编辑同一条记录
